<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>机器学习100天挑战-5,6/100 — 陈鹏的数据科学之路</title>
	<meta name="description" content="Title: 机器学习100天挑战-5,6/100; Date: 2019-09-13; Author: 陈鹏">
	<meta name="author" content="陈鹏">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://chenpeng1987.github.io/theme/html5.js"></script>
		<![endif]-->
	<link href="http://chenpeng1987.github.io/theme/css/ipython.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/bootswatch/3.2.0/simplex/bootstrap.min.css" rel="stylesheet">
	<link href="http://chenpeng1987.github.io/theme/css/local.css" rel="stylesheet">
	<link href="http://chenpeng1987.github.io/theme/css/pygments.css" rel="stylesheet">
</head>
<body>
<div class="container">
	<div class="page-header">
		<h1><a href="http://chenpeng1987.github.io/">陈鹏的数据科学之路</a>
			<br>	</div>
	<div class="row">
		<div class="col-md-8 col-md-offset-2">
<div class="article" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="text-center article-header">
		<h1 itemprop="name headline" class="article-title">机器学习100天挑战-5,6/100</h1>
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<h4 itemprop="name">陈鹏</h4>
		</span>
		<time datetime="2019-09-13T06:49:00+08:00" itemprop="datePublished">2019/09/13</time>
	</div>
	<div>
		Category:
		<span itemprop="articleSection">
			<a href="http://chenpeng1987.github.io/category/ml.html" rel="category">ML</a>
		</span>
	</div>
 
	<div>
		Tags:
		<span itemprop="keywords">
			<a href="http://chenpeng1987.github.io/tag/shu-ju-jupyter-ji-qi-xue-xi.html" rel="tag">数据 jupyter 机器学习</a>
		</span>
	</div>
	<div itemprop="articleBody" class="article-body"><style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#22797;&#20064;">&#22797;&#20064;<a class="anchor-link" href="#&#22797;&#20064;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#36923;&#36753;&#22238;&#24402;&#21040;&#24213;&#26159;&#20160;&#20040;">&#36923;&#36753;&#22238;&#24402;&#21040;&#24213;&#26159;&#20160;&#20040;<a class="anchor-link" href="#&#36923;&#36753;&#22238;&#24402;&#21040;&#24213;&#26159;&#20160;&#20040;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们今天来研究一下逻辑回归到底什么，以及他背后的数学是什么。我们需要知道如何计算代价函数，以及如何使用梯度下降法来将代价函数降低到最小。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>逻辑回归用于解决分类问题</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们可以通过使用sigmoid函数把线性回归的解映射到sigmoid空间中</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>逻辑回归的损失函数是通过极大似然法推导出来的</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>逻辑回归与线性回归相似，也是使用梯度下降法使损失函数值最小</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>选择sigmoid函数是因为他是连续函数，可以进行全域求导，并且其值域在0,1之间，大于0.5在正轴区间，小于0.5在负轴区间，从而形成分类</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>将样本的特征和样本发生的概率联系到一起，概率是一个数</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>逻辑回归本身只可以解决二分类问题</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="sigmoid&#20989;&#25968;">sigmoid&#20989;&#25968;<a class="anchor-link" href="#sigmoid&#20989;&#25968;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>这条曲线在0,1之间</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#38382;&#39064;&#65306;&#23545;&#20110;&#32473;&#23450;&#30340;&#26679;&#26412;&#25968;&#25454;&#38598;X&#65292;y&#65292;&#25105;&#20204;&#22914;&#20309;&#25214;&#21040;&#21442;&#25968;theta&#65292;&#20351;&#24471;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#21487;&#20197;&#26368;&#22823;&#31243;&#24230;&#33719;&#24471;&#26679;&#26412;&#25968;&#25454;&#38598;X&#23545;&#24212;&#30340;&#20998;&#31867;&#36755;&#20986;y&#65311;">&#38382;&#39064;&#65306;&#23545;&#20110;&#32473;&#23450;&#30340;&#26679;&#26412;&#25968;&#25454;&#38598;X&#65292;y&#65292;&#25105;&#20204;&#22914;&#20309;&#25214;&#21040;&#21442;&#25968;theta&#65292;&#20351;&#24471;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#21487;&#20197;&#26368;&#22823;&#31243;&#24230;&#33719;&#24471;&#26679;&#26412;&#25968;&#25454;&#38598;X&#23545;&#24212;&#30340;&#20998;&#31867;&#36755;&#20986;y&#65311;<a class="anchor-link" href="#&#38382;&#39064;&#65306;&#23545;&#20110;&#32473;&#23450;&#30340;&#26679;&#26412;&#25968;&#25454;&#38598;X&#65292;y&#65292;&#25105;&#20204;&#22914;&#20309;&#25214;&#21040;&#21442;&#25968;theta&#65292;&#20351;&#24471;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#21487;&#20197;&#26368;&#22823;&#31243;&#24230;&#33719;&#24471;&#26679;&#26412;&#25968;&#25454;&#38598;X&#23545;&#24212;&#30340;&#20998;&#31867;&#36755;&#20986;y&#65311;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwXJ0S.png" alt="nwXJ0S.png" border="0" width="500" height="500"/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwXNkQ.png" alt="nwXNkQ.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://imgchr.com/i/nwX0lq"><img src="https://s2.ax1x.com/2019/09/12/nwX0lq.png" alt="nwX0lq.png" border="0" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#36716;&#21270;&#20026;&#19968;&#20010;&#20989;&#25968;">&#36716;&#21270;&#20026;&#19968;&#20010;&#20989;&#25968;<a class="anchor-link" href="#&#36716;&#21270;&#20026;&#19968;&#20010;&#20989;&#25968;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwXh11.png" alt="nwXh11.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwXT0O.png" alt="nwXT0O.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#22914;&#20309;&#25214;&#21040;theta">&#22914;&#20309;&#25214;&#21040;theta<a class="anchor-link" href="#&#22914;&#20309;&#25214;&#21040;theta">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>使用梯度下降法求解</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwXLhd.png" alt="nwXLhd.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwXX9A.png" alt="nwXX9A.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwjFhj.png" alt="nwjFhj.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwjmuV.png" alt="nwjmuV.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://imgchr.com/i/nwjnBT"><img src="https://s2.ax1x.com/2019/09/12/nwjnBT.png" alt="nwjnBT.png" border="0" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwjuHU.png" alt="nwjuHU.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwjQN4.png" alt="nwjQN4.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/12/nwjl4J.png" alt="nwjl4J.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/13/nD4Hwd.png" alt="nD4Hwd.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/13/nD4LFI.png" alt="nD4LFI.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://s2.ax1x.com/2019/09/13/nD4OYt.png" alt="nD4OYt.png" border="0" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#38382;&#39064;&#65306;&#22914;&#20309;&#36827;&#34892;&#21521;&#37327;&#21270;">&#38382;&#39064;&#65306;&#22914;&#20309;&#36827;&#34892;&#21521;&#37327;&#21270;<a class="anchor-link" href="#&#38382;&#39064;&#65306;&#22914;&#20309;&#36827;&#34892;&#21521;&#37327;&#21270;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">LogisticRegression</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;初始化logistic Regression模型&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_theta</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">def</span> <span class="nf">_sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;_表示私有函数&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">eta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">n_iters</span><span class="o">=</span><span class="mf">1e4</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;根据训练集使用梯度下降法训练逻辑回归模型&#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
        <span class="s2">&quot;the size of X_train must be equal to the size of y_train&quot;</span>
        
        <span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">X_b</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
            <span class="n">y_hat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sigmoid</span><span class="p">(</span><span class="n">X_b</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y_hat</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y_hat</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="c1">#求梯度</span>
        <span class="k">def</span> <span class="nf">dJ</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">X_b</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">X_b</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sigmoid</span><span class="p">(</span><span class="n">X_b</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">X_b</span><span class="p">)</span>
        
        <span class="c1">#梯度下降算法</span>
        
        <span class="c1">#预测函数</span>
        
        
        
        
    
        
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://github.com/MLEveryday/100-Days-Of-ML-Code/blob/master/README.md">逻辑回归实现</a></p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div>
	<hr>
	<h2>Comments</h2>
</div>
		</div>
	</div> 	<!-- <hr> -->
</div> <!-- /container -->
<footer class="aw-footer bg-danger">
	<div class="container"> <!-- footer -->
		<div class="row">
			<div class="col-md-10 col-md-offset-1">
				<div class="row">
					<div class="col-md-3">
						<h4>Navigation</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="http://chenpeng1987.github.io">陈鹏的数据科学之路</a></li>
							<li><a href="http://chenpeng1987.github.io/aboutme/"><i class="fa fa-关于我 "></i> 关于我</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Author</h4>
						<ul class="list-unstyled my-list-style">
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Categories</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="http://chenpeng1987.github.io/category/data.html">data (3)</a></li>
							<li><a href="http://chenpeng1987.github.io/category/ml.html">ML (6)</a></li>
							<li><a href="http://chenpeng1987.github.io/category/python_finance.html">python_finance (1)</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Links</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="https://github.com/chenpeng1987?tab=repositories">github</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</footer>
<div class="container">
	<div class="row">
		<div class="col-md-12 text-center center-block aw-bottom">
			<p>&copy; 陈鹏 2016</p>
			<p>Powered by Pelican</p>
		</div>
	</div>
</div>
<!-- JavaScript -->
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
	$("div.collapseheader").click(function () {
		$header = $(this).children("span").first();
		$codearea = $(this).children(".input_area");
		$codearea.slideToggle(500, function () {
			$header.text(function () {
				return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
			});
		});
	});
});
</script>
</body>
</html>